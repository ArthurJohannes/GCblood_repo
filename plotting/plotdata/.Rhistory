server = function(input, output) { }
)
library (shiny)
shinyApp(
ui = bootstrapPage(
selectizeInput("variable", "Variable:", c("One", "Two", "Three"),
multiple = TRUE,
options = list(maxItems = 2))
),
server = function(input, output) { }
)
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
library (gridExtra)
library (gridExtra)
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
library (gridExtra)
library (grid)
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
?qplot ()
qplot(x, y = NULL, ..., data, facets = NULL, margins = FALSE,
geom = "auto", xlim = c(NA, NA), ylim = c(NA, NA), log = "",
main = NULL, xlab = deparse(substitute(x)),
ylab = deparse(substitute(y)), asp = NA, stat = NULL, position = NULL)
qplot(x, y = NULL, data, facets = NULL, margins = FALSE,
geom = "auto", xlim = c(NA, NA), ylim = c(NA, NA), log = "",
main = NULL, xlab = deparse(substitute(x)),
ylab = deparse(substitute(y)), asp = NA, stat = NULL, position = NULL)
qplot(x, y = NULL, data, facets = NULL, margins = FALSE,
geom = "auto", xlim = c(NA, NA), log = "",
main = NULL, xlab = deparse(substitute(x)),
ylab = deparse(substitute(y)), asp = NA, stat = NULL, position = NULL)
qplot(mpg, wt, data = mtcars)
plot(mpg, wt, data = mtcars, size = cyl)
colnames (mtcars)
plot(mpg, wt, data = mtcars, size = mtcars$cyl)
plot(mtcars$mpg, mtcars$wt, data = mtcars, size = mtcars$cyl)
qplot(mpg, wt, data = mtcars, size = cyl)
qplot(mpg, wt, data = mtcars, size = 1)
qplot(mpg, wt, data = mtcars, size = 10)
qplot(mpg, wt, data = mtcars, size = 0.1)
summary (cyl)
a <  qplot(mpg, wt, data = mtcars, geom = "point")
qplot(mpg, wt, data = mtcars)
qplot(mpg, wt, data = mtcars, geom = "line")
qplot(mpg, wt, data = mtcars, geom = "point")
a <- qplot(mpg, wt, data = mtcars)
a
a <- qplot(mpg, wt, data = mtcars, geom = "point")
a
a <- qplot(mpg, wt, data = mtcars, geom = "line")
a
a <- qplot(mpg, wt, data = mtcars, geom = "line", size = 10)
a
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
a <- qplot(mpg, wt, data = mtcars, geom = "line", size = 10)
a <- a  + theme ( axis.text.x = element_blank ())
a
a <- qplot(mpg, wt, data = mtcars)
a < a + geom_line(size = 10)
a <- a + geom_line(size = 10)
a
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('F:/bloodCells09082018')
shiny::runApp('F:/bloodCells09082018')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodCells09082018')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
rm (list = ls ())
shiny::runApp('F:/bloodVisX112017')
shiny::runApp('F:/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
install.packages("WGCNA")
## try http:// if https:// URLs are not supported
source("https://bioconductor.org/biocLite.R")
biocLite("RCytoscape")
library (RCytoscape)
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
library(shiny)
library(plotly)
ui <- fluidPage(
downloadButton('ExportPlot', 'Export as png'),
plotlyOutput("plot")
)
server <- function(input, output) {
# generate the plot
thePlot <- reactive({
p <- plot_ly(mtcars, x = ~mpg, y = ~wt)
})
# renderPlotly()
output$plot <- renderPlotly({
thePlot()
})
# download
output$ExportPlot <- downloadHandler(
# file name
filename <- 'plot.png',
# content
content = function(file){
# create plot
export(p = thePlot(), file = 'tempPlot.png')
# hand over the file
file.copy('tempPlot.png',file)
}
)
}
shinyApp(ui, server)
ui <- fluidPage(
downloadButton('ExportPlot', 'Export as png'),
plotlyOutput("plot")
)
server <- function(input, output) {
# generate the plot
thePlot <- reactive({
p <- plot_ly(mtcars, x = ~mpg, y = ~wt)
})
# renderPlotly()
output$plot <- renderPlotly({
thePlot()
})
# download
output$ExportPlot <- downloadHandler(
# file name
filename <- 'plot.png',
# content
content = function(file){
# create plot
export(p = thePlot(), file = 'tempPlot.png')
# hand over the file
file.copy('tempPlot.png',file)
}
)
}
shinyApp(ui, server)
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
a <- c(1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2)
b <- 2*a
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
head (gse11103meta)
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
4+4
dir ()
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
log (1)
log (o)
log (0)
exp (1)
log (2.718282)
2.718282 ^ 0.5
1.648721/6
vervalfn <- function (x) {2.718282^-0.2747868*x}
vervalfn(0)
vervalfn(6)
vervalfn <- function (x) {2.718282^(-0.2747868*x)}
vervalfn(0)
vervalfn(6)
log (1/2)
-0.6931472 /6
vervalfn <- function (x) {2.718282^( -0.1155245*x)}
vervalfn(0)
vervalfn(6)
vervalfn(24)
vervalfn(48)
vervalfn(76)
19800 *0.0001537992
dir ()
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
5 + 6
ir ()
dir ()
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
library (readxl)
dir ()
5 + 5
library (readxl)
5 +5
dir ()
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
dir ()
query <- "DAAM2"
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
dir ()
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
dir ()
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
install.packages("rJava")
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
funexp <- function (x) {2^x}
ind1 <- c (100,50,200,400,700,100,400,440,50,75,30,10,200,50,100,75)
ind2 <- c (10,8,15,20,3,15,19,20,80,100,75,200,50,300,110,50)
base1 <- c (1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0)
base2 <- c (0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1)
cor (base1,bas2)
cor (base1,base2)
cor (ind1,ind2)
ind1b <- c (1000,500,2000,4000,7000,1000,4000,4400,50,75,30,10,200,50,100,75)
cor (ind1b,ind2)
ind1b <- c (1000,250,4000,400,1400,1000,4000,440,100,75,30,10,200,50,100,75)
cor (ind1b, ind2)
ind1b <- c (10000,250,4000,4000,1400,1000,40000,440,100,75,30,10,200,50,100,75)
cor (ind1b, ind2)
DEG1 <-ind1 [1:8] /ind1 [9:16]
DEG2b <- ind1b [1:8] /ind1b [9:16]
DEG1
DEG1 <-mean (ind1 [1:8]) /mean (ind1 [9:16])
DEG2 <-mean (ind2 [1:8]) /mean (ind2 [9:16])
DEG1 <-mean (ind1b [1:8]) /mean (ind1b [9:16])
cor (ind1,ind2b)
cor (ind1b,ind2)
DEG1
deg2
DEG2
1/DEG2
vervang <- ind1b [9:16] *10
ind1c <- c (ind1b [1:8], vervang [8:1])
iind1
ind1c
DEG1c <-mean (ind1c [1:8]) /mean (ind1c [9:16])
DEG1c
DEG2
cor (ind1c, ind2)
ind1c
ind2
vervang2 <- ind1b [9:16] *30
ind1d <- c (ind1b [1:8], vervang2 [8:1])
DEG1d <-mean (ind1d [1:8]) /mean (ind1d [9:16])
DEG1d
DEG2
cor (ind1d,ind2)
f <- rep (1, times = 16)
cor (ind1d,f)
f <- rep (c (1,0) times = c (8))
f <- rep (c (1,0), times = c (8))
cor (ind1d,f)
5 +5
5+5
5 +4
5+4
5+3
?tan ()
3+3
5+ 4
4+4
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
5+3
dir ()
4+3
5+4
4+3
3+2
4+3
5+5
4+5
3+3
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
3+4
2+2
2+2
4+2
5+4
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
1+2
4+2
2+3
2+2
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX112017')
3+2
2+1
3+3
dir ()
4+2
4+3
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
shiny::runApp('C:/Users/Arthur/Desktop/CourseraR/shinyoefening/bloodVisX')
2+2
2+1
2+2
3+2
2+2
2+3
3+2
3+2
5+3
2+2
3+2
1+3
3+2
3+3
2^-1.414
2^-1.295
2^-1.295
2^-1.021
e^-1.414
ln (1)
loge (7)
log (1)
log (7)
2.71828^-1.414
2.71828^-1.295
2.71828^1.295
2.71828^-1.295
2.71828^-1.021
c (0.2431689 + 0.2738981 + 0.2738981 +  0.3602348) /4
ditte <-  c (1.36,	1.359,	2.786,	1.641,	0.053,	-0.379,	1.31,	0.003)
editte <- 2.71828^ditte
editte
t,test (editte [1:4], editte [5,8])
t.test (editte [1:4], editte [5,8])
t.test (editte [1:4], editte [5:8])
log2 (7.291201/1.612038 )
log2 (1.612038/7.291201 )
zbtb16 <-  c(-2.822,	-3.532,	-1.935,	-3.169,	4.008,	2.697,	2.497,	2.136)
ezbtb16 <-   2.71828^c(-2.822,	-3.532,	-1.935,	-3.169,	4.008,	2.697,	2.497,	2.136)
t.test (ezbtb16 [1:4], ezbtb16[5:8])
ezbtb16
t.test (ezbtb16 [1:4], ezbtb16 [5:8])
ezbtb16 <- c (ezbtb16, 10)
t.test (ezbtb16 [1:4], ezbtb16 [5:9])
ezbtb16 <- c (ezbtb16, 15)
t.test (ezbtb16 [1:4], ezbtb16 [5:10])
ezbtb16
alox15b <- c (1.196,	1.122,	0.525,	0.341,	4.073,	3.178,	2.939,	2.857)
ealox15b <-  2.71828^alox15b
ealoxa5b
ealox15b
t.test (ealox15b[1:4], ealox15b[5:10])
t.test (ealox15b[1:4], ealox15b[5:10],paired = TRUE)
t.test (ealox15b[1:4], ealox15b[5:8])
t.test (ealox15b[1:4], ealox15b[5:8],paired = TRUE)
t.test (c (1,2,3,4), c (20,23,27,31))
t.test (alox15b[1:4], alox15b[5:8])
zbtb16
t.test (zbtb16 [1:4], zbtb16 [5:8])
tsc22d3 <- c (1.48,	1.522,	2.176,	2.259,	4.642,	4.413,	4.854,	4.79)
t.test (tsc22d3[1:4], tsc22d3 [5:8])
etsc22d3  <- 2.71828^tsc22d3
etsc22d3
t.test (etsc22d3[1:4], etsc22d3 [5:8])
3+2
3+2
2+3
setwd("D:/voorgithub/githubsepsisdatasets")
dir ()
setwd("~/GitHub/GCblood_repo/data/expressiontables_severe")
dir ()
emtab5273 <- readRDS ("Tableemtab5273")
gse32707 <- readRDS ("Tablegse32707")
setwd("D:/cortisolmanuscript/violin")
dir ()
modulelijstgpl10558 <- readRDS ("modulelijstilluminav3v4.rds" )
modulelijstgpl570 <- readRDS ("modulelijstaffymetrixgpl570.rds")
modulelijstrnaseq <- readRDS ( "modulelijstRNAseq3.rds" )
modulelijstrnaseq
modulelijstgpl10558
allegpl10558idrefs <-  character ()
for ( in 1:8){dezeidrefs <- modulelijstgpl10558 [[i]]; allegpl10558idrefs <- c (allegpl10558idrefs, dezeidrefs)}
for ( in 1:8){dezeidrefs <- modulelijstgpl10558 [[i]]; allegpl10558idrefs <- c (allegpl10558idrefs, dezeidrefs)}
for ( i in 1:8){dezeidrefs <- modulelijstgpl10558 [[i]]; allegpl10558idrefs <- c (allegpl10558idrefs, dezeidrefs)}
setdiff (allegpl10558idrefs, as.character (gse32707$ID_REF))
setdiff (allegpl10558idrefs, as.character (emtab5273$ID_REF))
emtab5273 [1:5,1:5]
setwd("C:/Users/Arthur/Desktop/bloodRNA/data/niewesetsfebr2018")
dir ()
gse77791 <- readRDS ("Tablegse77791"   )
setwd("C:/Users/Arthur/Desktop/bloodRNA/data/malaria")
dir ()
gse34404 <- readRDS ( "Tablegse34404" )
setdiff (allegpl10558idrefs, as.character (gse34404$ID_REF))
names (modulelijstrnaseq)
names (modulelijstrnaseq)
module_genes_list <- list ()
module_genes_list$Tcell <- modulelijstrnaseq$Tcellnaive
module_genes_list$SIM <- modulelijstrnaseq$Sevinflam
module_genes_list$FAM20Agr <- modulelijstrnaseq$FAM20Ainflamkort
module_genes_list$GC-1 <- modulelijstrnaseq$GCcircadianenstress
module_genes_list$GC_1 <- modulelijstrnaseq$GCcircadianenstress
module_genes_list$GC_2 <- modulelijstrnaseq$GCinflam
module_genes_list$IFNgamma <- modulelijstrnaseq$infgamma
module_genes_list$IFNalpha<- modulelijstrnaseq$infalpha
names (module_genes_list)
setwd("~/GitHub/GCblood_repo/plotting/plotdata")
gse154918 <- readRDS ("Tablegse154918")
gse154918meta <- readRDS ("gse154918meta.rds")
tabeldf <- gse154918
allgenesonplatform <- as.character (gse154918$IDENTIFIER)
for (k in 1:7) { counter <- counter +1 ; modulegenes <- modulelijst [[k]]
presentmodulegenes <- intersect (modulegenes, allgenesonplatform)
ditjes <- numeric ();for (xx in presentmodulegenes) {ditje <- which (allgenesonplatform == xx); ditjes <- c (ditjes, ditje)}
for (k in 1:7) { counter <- counter +1 ; modulegenes <- module_genes_list [[k]]
presentmodulegenes <- intersect (modulegenes, tabeldf$IDENTIFIER)
ditjes <- numeric ();for (xx in presentmodulegenes) {ditje <- which (tabeldf$IDENTIFIER == xx); ditjes <- c (ditjes, ditje)}
for (k in 1:10) { counter <- counter +1 ; modulegenes <- modulelijstrnaseq [[k]]
##  moduleidrefs <- modulelijst$infalphainflamilluminaV4idrefs
presentmodulegenes <- intersect (modulegenes, tabeldf$IDENTIFIER)
ditjes <- numeric ();for (xx in presentmodulegenes) {ditje <- which (tabeldf$IDENTIFIER == xx); ditjes <- c (ditjes, ditje)}
modulelijst <- modulelijstrnaseq
tabeldf <- gse154918
funexp <- function (x) {2^x}
dimensies <- dim (tabeldf)
colaantal <- dimensies [2]
colnames ( tabeldf) [1:2] <- c ("ID_REF","IDENTIFIER")
tabeldfexp <- apply (tabeldf [,3:colaantal],2,funexp)
demodulenamen <- names (modulelijst)
zoveel <- dimensies [2] -2
datasetje <- rep ("gsexxxx", times = zoveel)
voormijnplot <- as.data.frame (cbind (1:zoveel, datasetje))
rownames (voormijnplot) <- 1:zoveel
counter <- 0
for (k in 1:10) { counter <- counter +1 ; modulegenes <- modulelijst [[k]]
##  moduleidrefs <- modulelijst$infalphainflamilluminaV4idrefs
presentmodulegenes <- intersect (modulegenes, tabeldf$IDENTIFIER)
ditjes <- numeric ();for (xx in presentmodulegenes) {ditje <- which (tabeldf$IDENTIFIER == xx); ditjes <- c (ditjes, ditje)}
##  vervolgens:
ranges <- numeric () ; for (i in presentmodulegenes)  {
deze <- which (tabeldf$IDENTIFIER == i)
range <- max (tabeldfexp [deze,])- min ((tabeldfexp [deze,]))
ranges <- c (ranges, range)
}
## deze regel als maar een gene
if (length(ditjes) == 1 ){ditjes <- c (ditjes,ditjes)}
dfje <- as.data.frame(cbind (as.character (tabeldf$IDENTIFIER [ditjes]), as.character (tabeldf$ID_REF[ditjes]), ranges ))
colnames (dfje) [1:2] <- c ("gene","ID-REF")
## GEWICHT code klopt nog niet goed, op de plot moet gemiddeld rpm te zien zijn , is aftrekken van BG hier wel nodig  ?
fractiesvan1 <- ranges /sum (ranges)
gewichten <- 1/fractiesvan1
dfje$weights <- gewichten
## som <- sum (ranges)
## gewichten <- 1/(ranges /sum (ranges ))
## dfje$weights <- gewichten/sum (gewichten)
dfje$genenrs <- ditjes
## berekentabel <-  tabeldfexp [dfje$genenrs,]* dfje$weights
berekentabel <-  tabeldfexp [dfje$genenrs,]* dfje$weights / (length ( presentmodulegenes))
ditgetal <- dim (berekentabel) [1]
##  twee regels hieronder zouden voor RNAseq data weg kunnen want geen platform background
## kleinstewaarden <- numeric (); for (p in 1:ditgetal ){kleinste <- min (berekentabel[p,],na.rm = TRUE); kleinstewaarden <- c (kleinstewaarden,kleinste)}
## berekentabel <- berekentabel - kleinstewaarden
modulewaarden <- colMeans (berekentabel,na.rm = TRUE )
voormijnplot$modulewaarden <- as.numeric (as.character (modulewaarden))
colnames (voormijnplot) [counter +2] <- demodulenamen [counter]
}
voormijnplot <- voormijnplot [,-1]
colnames ( voormijnplot) [1] <- "dataset"
head (voormijnplot)
dim (voormijnplot)
levels (gse154918meta$characteristics_ch1)
illness <- gse154918meta$characteristics_ch1
levels (illness) <- c ("healthy","ill","ill","ill","ill","ill")
voormijnplot$illness <- illness
head (voormijnplot)
tail (voormijnplot)
